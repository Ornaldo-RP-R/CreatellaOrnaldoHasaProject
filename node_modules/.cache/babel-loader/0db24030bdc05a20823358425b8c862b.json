{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\asjan\\\\Desktop\\\\Creatella\\\\src\\\\components\\\\ProductScrollView\\\\ProductScrollView.component.jsx\";\nimport React from \"react\";\nimport Spinner from \"../Spinner/spinner.component\";\nimport { connect } from \"react-redux\";\nimport ProductCard from \"../components/Product/Product.component\";\nimport { setDisplayedArrayOfProducts, setValueByName } from \"../../redux/Shop/Shop.actions\";\nlet ProductsCount = 0;\n\nconst findRandomNotFirstAdd = AddsIndexes => {\n  let zIndex = Math.floor(Math.random() * 1000);\n\n  while (zIndex == AddsIndexes[AddsIndexes.length - 1]) {\n    zIndex = Math.floor(Math.random() * 1000);\n  }\n\n  return zIndex;\n};\n\nconst handleScroll = async (e, Index, setDisplayedArrayOfProducts, DisplayedProductsArray, ProductsFullArray, AddsIndexes) => {\n  if ( //Check when users reach the bottom\n  e.target.scrollHeight - e.target.scrollTop === e.target.clientHeight && Index <= 481) {\n    await setValueByName({\n      name: \"LoadingMore\",\n      value: true\n    }); // Tell message to the user in ex \"Loading more\"\n\n    await setValueByName({\n      name: \"AddsIndexes\",\n      value: [...AddsIndexes, findRandomNotFirstAdd(AddsIndexes)]\n    }); // Set timeout so even if data come faster Loading will be shown to users for 1/3s just for design\n\n    await setTimeout(async () => {\n      await setValueByName({\n        name: \"Index\",\n        value: Index + 20\n      }); //Get more products from full array that i use in redux state\n\n      await setDisplayedArrayOfProducts(DisplayedProductsArray.concat(ProductsFullArray.slice(Index, Index + 20))); // Keep truck of index\n\n      await setValueByName({\n        name: \"Index\",\n        value: Index + 20\n      }); //Stop loading more\n\n      await setValueByName({\n        name: \"LoadingMore\",\n        value: false\n      }); //Check if all products have been displayed\n\n      if (Index <= ProductsFullArray.length && Index >= ProductsFullArray.length - 20) {\n        setDisplayedArrayOfProducts(ProductsFullArray);\n      }\n    }, 300);\n  }\n};\n\nconst ProductScrollView = ({\n  DisplayedProductsArray,\n  SpinnerVissibility,\n  AddsIndexes,\n  LoadingMore,\n  Index,\n  setDisplayedArrayOfProducts,\n  ProductsFullArray\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  className: \"Products\",\n  onScroll: e => {\n    handleScroll(e, Index, setDisplayedArrayOfProducts, DisplayedProductsArray, ProductsFullArray, AddsIndexes);\n  },\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 3\n  }\n}, SpinnerVissibility === true ? /*#__PURE__*/React.createElement(Spinner, {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 94,\n    columnNumber: 7\n  }\n}) : DisplayedProductsArray.map(Product => {\n  ProductsCount++;\n  return ProductsCount % 20 == 0 ? /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(ProductCard, {\n    id: Product.id,\n    price: Product.price,\n    size: Product.size,\n    face: Product.face,\n    date: Product.date,\n    AddsIndexes: AddsIndexes,\n    ProductsCount: ProductsCount,\n    AdsVisibility: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 13\n    }\n  })) : /*#__PURE__*/React.createElement(ProductCard, {\n    id: Product.id,\n    price: Product.price,\n    size: Product.size,\n    face: Product.face,\n    date: Product.date,\n    AddsIndexes: AddsIndexes,\n    ProductsCount: ProductsCount,\n    AdsVisibility: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 11\n    }\n  });\n}), LoadingMore === true ? /*#__PURE__*/React.createElement(\"div\", {\n  className: \"LoadingMoreend\",\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 127,\n    columnNumber: 7\n  }\n}, \"Loading ...\") : null, Index != 0 && Index === ProductsFullArray.length ? /*#__PURE__*/React.createElement(\"div\", {\n  className: \"LoadingMoreend\",\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 130,\n    columnNumber: 7\n  }\n}, \"end of catalogue\") : null);\n\nconst mapStateToProps = state => ({\n  DisplayedProductsArray: state.shop.DisplayedProductsArray,\n  ProductsFullArray: state.shop.ProductsFullArray,\n  SpinnerVissibility: state.spinner.SpinnerVissibility,\n  AddsIndexes: state.shop.AddsIndexes,\n  Index: state.shop.Index,\n  LoadingMore: state.shop.LoadingMore\n});\n\nconst mapDispatchToProps = dispatch => ({\n  setDisplayedArrayOfProducts: DisplayedArrayOfProducts => dispatch(setDisplayedArrayOfProducts(DisplayedArrayOfProducts)),\n  setValueByName\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ProductScrollView);","map":{"version":3,"sources":["C:/Users/asjan/Desktop/Creatella/src/components/ProductScrollView/ProductScrollView.component.jsx"],"names":["React","Spinner","connect","ProductCard","setDisplayedArrayOfProducts","setValueByName","ProductsCount","findRandomNotFirstAdd","AddsIndexes","zIndex","Math","floor","random","length","handleScroll","e","Index","DisplayedProductsArray","ProductsFullArray","target","scrollHeight","scrollTop","clientHeight","name","value","setTimeout","concat","slice","ProductScrollView","SpinnerVissibility","LoadingMore","map","Product","id","price","size","face","date","mapStateToProps","state","shop","spinner","mapDispatchToProps","dispatch","DisplayedArrayOfProducts"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport Spinner from \"../Spinner/spinner.component\";\r\nimport { connect } from \"react-redux\";\r\nimport ProductCard from \"../components/Product/Product.component\";\r\nimport {\r\n  setDisplayedArrayOfProducts,\r\n  setValueByName,\r\n} from \"../../redux/Shop/Shop.actions\";\r\nlet ProductsCount = 0;\r\nconst findRandomNotFirstAdd = (AddsIndexes) => {\r\n  let zIndex = Math.floor(Math.random() * 1000);\r\n  while (zIndex == AddsIndexes[AddsIndexes.length - 1]) {\r\n    zIndex = Math.floor(Math.random() * 1000);\r\n  }\r\n  return zIndex;\r\n};\r\nconst handleScroll = async (\r\n  e,\r\n  Index,\r\n  setDisplayedArrayOfProducts,\r\n  DisplayedProductsArray,\r\n  ProductsFullArray,\r\n  AddsIndexes\r\n) => {\r\n  if (\r\n    //Check when users reach the bottom\r\n    e.target.scrollHeight - e.target.scrollTop === e.target.clientHeight &&\r\n    Index <= 481\r\n  ) {\r\n    await setValueByName({\r\n      name: \"LoadingMore\",\r\n      value: true,\r\n    });\r\n    // Tell message to the user in ex \"Loading more\"\r\n    await setValueByName({\r\n      name: \"AddsIndexes\",\r\n      value: [...AddsIndexes, findRandomNotFirstAdd(AddsIndexes)],\r\n    });\r\n    // Set timeout so even if data come faster Loading will be shown to users for 1/3s just for design\r\n    await setTimeout(async () => {\r\n      await setValueByName({\r\n        name: \"Index\",\r\n        value: Index + 20,\r\n      });\r\n      //Get more products from full array that i use in redux state\r\n      await setDisplayedArrayOfProducts(\r\n        DisplayedProductsArray.concat(\r\n          ProductsFullArray.slice(Index, Index + 20)\r\n        )\r\n      );\r\n      // Keep truck of index\r\n      await setValueByName({\r\n        name: \"Index\",\r\n        value: Index + 20,\r\n      });\r\n      //Stop loading more\r\n      await setValueByName({\r\n        name: \"LoadingMore\",\r\n        value: false,\r\n      });\r\n      //Check if all products have been displayed\r\n      if (\r\n        Index <= ProductsFullArray.length &&\r\n        Index >= ProductsFullArray.length - 20\r\n      ) {\r\n        setDisplayedArrayOfProducts(ProductsFullArray);\r\n      }\r\n    }, 300);\r\n  }\r\n};\r\nconst ProductScrollView = ({\r\n  DisplayedProductsArray,\r\n  SpinnerVissibility,\r\n  AddsIndexes,\r\n  LoadingMore,\r\n  Index,\r\n  setDisplayedArrayOfProducts,\r\n  ProductsFullArray,\r\n}) => (\r\n  <div\r\n    className=\"Products\"\r\n    onScroll={(e) => {\r\n      handleScroll(\r\n        e,\r\n        Index,\r\n        setDisplayedArrayOfProducts,\r\n        DisplayedProductsArray,\r\n        ProductsFullArray,\r\n        AddsIndexes\r\n      );\r\n    }}\r\n  >\r\n    {SpinnerVissibility === true ? (\r\n      <Spinner></Spinner>\r\n    ) : (\r\n      DisplayedProductsArray.map((Product) => {\r\n        ProductsCount++;\r\n\r\n        return ProductsCount % 20 == 0 ? (\r\n          <div>\r\n            <ProductCard\r\n              id={Product.id}\r\n              price={Product.price}\r\n              size={Product.size}\r\n              face={Product.face}\r\n              date={Product.date}\r\n              AddsIndexes={AddsIndexes}\r\n              ProductsCount={ProductsCount}\r\n              AdsVisibility={true}\r\n            />\r\n          </div>\r\n        ) : (\r\n          <ProductCard\r\n            id={Product.id}\r\n            price={Product.price}\r\n            size={Product.size}\r\n            face={Product.face}\r\n            date={Product.date}\r\n            AddsIndexes={AddsIndexes}\r\n            ProductsCount={ProductsCount}\r\n            AdsVisibility={false}\r\n          />\r\n        );\r\n      })\r\n    )}\r\n    {LoadingMore === true ? (\r\n      <div className=\"LoadingMoreend\">Loading ...</div>\r\n    ) : null}\r\n    {Index != 0 && Index === ProductsFullArray.length ? (\r\n      <div className=\"LoadingMoreend\">end of catalogue</div>\r\n    ) : null}\r\n  </div>\r\n);\r\nconst mapStateToProps = (state) => ({\r\n  DisplayedProductsArray: state.shop.DisplayedProductsArray,\r\n  ProductsFullArray: state.shop.ProductsFullArray,\r\n\r\n  SpinnerVissibility: state.spinner.SpinnerVissibility,\r\n  AddsIndexes: state.shop.AddsIndexes,\r\n  Index: state.shop.Index,\r\n  LoadingMore: state.shop.LoadingMore,\r\n});\r\nconst mapDispatchToProps = (dispatch) => ({\r\n  setDisplayedArrayOfProducts: (DisplayedArrayOfProducts) =>\r\n    dispatch(setDisplayedArrayOfProducts(DisplayedArrayOfProducts)),\r\n  setValueByName,\r\n});\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ProductScrollView);\r\n"]},"metadata":{},"sourceType":"module"}