{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\asjan\\\\Desktop\\\\Creatella\\\\src\\\\App.jsx\";\nimport React from \"react\";\nimport axios from \"axios\";\nimport \"./App.css\";\nimport { connect } from \"react-redux\";\nimport { setFullArrayOfProducts, setDisplayedArrayOfProducts, setValueByName } from \"./redux/Shop/Shop.actions\";\nimport Filter from \"./components/Filter/Filter.component\";\nimport { toggleSpinner } from \"./redux/Spinner/Spinner.actions\";\nimport { setViewOfPage } from \"./redux/Page/Page.actions\";\nimport Spinner from \"./components/Spinner/spinner.component\";\n\nclass App extends React.Component {\n  constructor(...args) {\n    super(...args);\n\n    this.GetProducts = async () => {\n      //run Spinner\n      await this.props.toggleSpinner(); //start Api call\n\n      await axios.get(\"http://localhost:5000/products/?_pages=1&_limit=80\").then(response => {\n        //register  80 products to redux (80 becouse no need more for start and load faster)\n        this.props.setFullArrayOfProducts(response.data); // register products that we need to display to the user\n\n        this.props.setDisplayedArrayOfProducts(response.data.slice(0, 20)); //set Index to redux a variable that i use to keep truck of the product number shown to user\n\n        this.props.setValueByName({\n          name: \"Index\",\n          value: 20\n        });\n      }); //close spinner\n\n      await this.props.toggleSpinner(); // while user uses the pages full products will be registered not only (80)\n\n      axios.get(\"http://localhost:5000/products\").then(response => {\n        this.props.setFullArrayOfProducts(response.data);\n      });\n    };\n\n    this.handleScroll = async e => {\n      const {\n        Index,\n        setDisplayedArrayOfProducts,\n        DisplayedProductsArray,\n        ProductsFullArray\n      } = this.props;\n\n      if ( //Check when users reach the bottom\n      e.target.scrollHeight - e.target.scrollTop === e.target.clientHeight && Index <= 481) {\n        // Tell message to the user in ex \"Loading more\"\n        await this.props.setValueByName({\n          name: \"AddsIndexes\",\n          value: [...this.props.AddsIndexes, this.findRandomNotFirstAdd()]\n        }); // Set timeout so even if data come faster Loading will be shown to users for 1/3s just for design\n\n        await setTimeout(async () => {\n          await this.props.setValueByName({\n            name: \"Index\",\n            value: Index + 20\n          }); //Get more products from full array that i use in redux state\n\n          await setDisplayedArrayOfProducts(DisplayedProductsArray.concat(ProductsFullArray.slice(Index, Index + 20))); // Keep truck of index\n\n          await this.props.setValueByName({\n            name: \"Index\",\n            value: Index + 20\n          }); //Stop loading more\n\n          await this.props.setValueByName({\n            name: \"LoadingMore\",\n            value: false\n          }); //Check if all products have been displayed\n\n          if (Index <= ProductsFullArray.length && Index >= ProductsFullArray.length - 20) {\n            setDisplayedArrayOfProducts(ProductsFullArray);\n          }\n        }, 300);\n      }\n    };\n\n    this.findRandomNotFirstAdd = () => {\n      let zIndex = Math.floor(Math.random() * 1000);\n\n      while (zIndex == this.props.AddsIndexes[this.props.AddsIndexes.length - 1]) {\n        zIndex = Math.floor(Math.random() * 1000);\n      }\n\n      return zIndex;\n    };\n  }\n\n  // Find Date format if 1week or less ex:\"2 days ago\"\n  //otherwise i let full date YY/MM/DD more confortable for human eye otherwise i could do a .toString for fully date\n  findCorrectDateFormat(productDate) {\n    let now = new Date();\n    let date = \"\"; //Make first check foramt of 1week or less from today's date\n\n    if (now.getFullYear() === productDate.getFullYear() && now.getMonth() === productDate.getMonth() && now.getDate() - productDate.getDate() >= 7) {\n      //make small checks if is day ago/minutes/hours\n      if (now.getDate() - productDate.getDate() === 0) {\n        if (now.getHours() - productDate.getHours() === 0) {\n          if (now.getMinutes() - productDate.getMinutes() === 0) {\n            if (now.getSeconds() - productDate.getSeconds() != 0) {\n              return date = `${now.getSeconds() - productDate.getSeconds()} minutes ago`;\n            }\n          } else {\n            return date = `${now.getMinutes() - productDate.getMinutes()} minutes ago`;\n          }\n        } else {\n          return date = `${now.getHours() - productDate.getHours()} hours ago`;\n        }\n      } else {\n        return date = `${now.getDate() - productDate.getDate()} days ago`;\n      }\n    } else {\n      //otherwise full date format\n      return date = \"since \" + productDate.getFullYear() + \"/\" + productDate.getMonth() + \"/\" + productDate.getDate();\n    }\n\n    return date;\n  } //Make Api call and get Products Info\n\n\n  componentDidMount() {\n    //Call function to get products when components load\n    this.GetProducts();\n  } //Handle Scrolling  to give more products\n\n\n  render() {\n    let ProductsCount = 0;\n    const {\n      DisplayedProductsArray,\n      SpinnerVissibility,\n      LoadingMore,\n      Index,\n      ProductsFullArray,\n      AddsIndexes,\n      ViewOfPage,\n      setViewOfPage\n    } = this.props;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"filter-Products-Header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"Filter-Header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Filter, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"SwitchView\",\n      onClick: setViewOfPage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 9\n      }\n    }, ViewOfPage === \"Pagination\" ? \"Turn on Scrolling View\" : \"Turn on Page View\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"Products\",\n      onScroll: this.handleScroll,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 9\n      }\n    }, SpinnerVissibility === true ? /*#__PURE__*/React.createElement(Spinner, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 13\n      }\n    }) : DisplayedProductsArray.map(Product => {\n      ProductsCount++;\n      return ProductsCount % 20 == 0 ? /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        id: Product.id,\n        className: \"Each-Product\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"face\",\n        style: {\n          fontSize: `${Product.size}px`\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 21\n        }\n      }, Product.face), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"OrderNow\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 21\n        }\n      }, \"Order now\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"price\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 21\n        }\n      }, \"$\", /*#__PURE__*/React.createElement(\"span\", {\n        style: {\n          color: \"black\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 23\n        }\n      }, ` ${Product.price}`)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"date\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 21\n        }\n      }, `${this.findCorrectDateFormat(new Date(Product.date))}`)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"advertisment\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        onLoad: () => {},\n        class: \"ad\",\n        src: `http://localhost:5000/ads?r=${AddsIndexes[ProductsCount / 20]}`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 21\n        }\n      }))) : /*#__PURE__*/React.createElement(\"div\", {\n        id: Product.id,\n        className: \"Each-Product\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"face\",\n        style: {\n          fontSize: `${Product.size}px`\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 19\n        }\n      }, Product.face), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"OrderNow\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 19\n        }\n      }, \"Order now\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"price\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 19\n        }\n      }, \"$\", /*#__PURE__*/React.createElement(\"span\", {\n        style: {\n          color: \"black\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 21\n        }\n      }, ` ${Product.price}`)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"date\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 19\n        }\n      }, `${this.findCorrectDateFormat(new Date(Product.date))}`));\n    }), LoadingMore === true ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"LoadingMoreend\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 13\n      }\n    }, \"Loading ...\") : null, Index != 0 && Index === ProductsFullArray.length ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"LoadingMoreend\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 13\n      }\n    }, \"end of catalogue\") : null));\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  DisplayedProductsArray: state.shop.DisplayedProductsArray,\n  ProductsFullArray: state.shop.ProductsFullArray,\n  Index: state.shop.Index,\n  LoadingMore: state.shop.LoadingMore,\n  SpinnerVissibility: state.spinner.SpinnerVissibility,\n  NoMoreToShow: state.shop.NoMoreToShow,\n  AddsIndexes: state.shop.AddsIndexes,\n  ViewOfPage: state.page.ViewOfPage\n});\n\nconst mapDispatchToProps = dispatch => ({\n  setFullArrayOfProducts: FullArrayOfProducts => dispatch(setFullArrayOfProducts(FullArrayOfProducts)),\n  setDisplayedArrayOfProducts: DisplayedArrayOfProducts => dispatch(setDisplayedArrayOfProducts(DisplayedArrayOfProducts)),\n  toggleSpinner: () => dispatch(toggleSpinner()),\n  setValueByName: NameValue => dispatch(setValueByName(NameValue)),\n  setViewOfPage: () => dispatch(setViewOfPage())\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);","map":{"version":3,"sources":["C:/Users/asjan/Desktop/Creatella/src/App.jsx"],"names":["React","axios","connect","setFullArrayOfProducts","setDisplayedArrayOfProducts","setValueByName","Filter","toggleSpinner","setViewOfPage","Spinner","App","Component","GetProducts","props","get","then","response","data","slice","name","value","handleScroll","e","Index","DisplayedProductsArray","ProductsFullArray","target","scrollHeight","scrollTop","clientHeight","AddsIndexes","findRandomNotFirstAdd","setTimeout","concat","length","zIndex","Math","floor","random","findCorrectDateFormat","productDate","now","Date","date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","componentDidMount","render","ProductsCount","SpinnerVissibility","LoadingMore","ViewOfPage","map","Product","id","fontSize","size","face","color","price","mapStateToProps","state","shop","spinner","NoMoreToShow","page","mapDispatchToProps","dispatch","FullArrayOfProducts","DisplayedArrayOfProducts","NameValue"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport axios from \"axios\";\r\nimport \"./App.css\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  setFullArrayOfProducts,\r\n  setDisplayedArrayOfProducts,\r\n  setValueByName,\r\n} from \"./redux/Shop/Shop.actions\";\r\nimport Filter from \"./components/Filter/Filter.component\";\r\nimport { toggleSpinner } from \"./redux/Spinner/Spinner.actions\";\r\nimport { setViewOfPage } from \"./redux/Page/Page.actions\";\r\nimport Spinner from \"./components/Spinner/spinner.component\";\r\nclass App extends React.Component {\r\n  // Find Date format if 1week or less ex:\"2 days ago\"\r\n  //otherwise i let full date YY/MM/DD more confortable for human eye otherwise i could do a .toString for fully date\r\n  findCorrectDateFormat(productDate) {\r\n    let now = new Date();\r\n    let date = \"\";\r\n    //Make first check foramt of 1week or less from today's date\r\n    if (\r\n      now.getFullYear() === productDate.getFullYear() &&\r\n      now.getMonth() === productDate.getMonth() &&\r\n      now.getDate() - productDate.getDate() >= 7\r\n    ) {\r\n      //make small checks if is day ago/minutes/hours\r\n      if (now.getDate() - productDate.getDate() === 0) {\r\n        if (now.getHours() - productDate.getHours() === 0) {\r\n          if (now.getMinutes() - productDate.getMinutes() === 0) {\r\n            if (now.getSeconds() - productDate.getSeconds() != 0) {\r\n              return (date = `${\r\n                now.getSeconds() - productDate.getSeconds()\r\n              } minutes ago`);\r\n            }\r\n          } else {\r\n            return (date = `${\r\n              now.getMinutes() - productDate.getMinutes()\r\n            } minutes ago`);\r\n          }\r\n        } else {\r\n          return (date = `${\r\n            now.getHours() - productDate.getHours()\r\n          } hours ago`);\r\n        }\r\n      } else {\r\n        return (date = `${now.getDate() - productDate.getDate()} days ago`);\r\n      }\r\n    } else {\r\n      //otherwise full date format\r\n      return (date =\r\n        \"since \" +\r\n        productDate.getFullYear() +\r\n        \"/\" +\r\n        productDate.getMonth() +\r\n        \"/\" +\r\n        productDate.getDate());\r\n    }\r\n    return date;\r\n  }\r\n  //Make Api call and get Products Info\r\n  GetProducts = async () => {\r\n    //run Spinner\r\n    await this.props.toggleSpinner();\r\n    //start Api call\r\n    await axios\r\n      .get(\"http://localhost:5000/products/?_pages=1&_limit=80\")\r\n      .then((response) => {\r\n        //register  80 products to redux (80 becouse no need more for start and load faster)\r\n        this.props.setFullArrayOfProducts(response.data);\r\n        // register products that we need to display to the user\r\n        this.props.setDisplayedArrayOfProducts(response.data.slice(0, 20));\r\n        //set Index to redux a variable that i use to keep truck of the product number shown to user\r\n        this.props.setValueByName({ name: \"Index\", value: 20 });\r\n      });\r\n    //close spinner\r\n    await this.props.toggleSpinner();\r\n    // while user uses the pages full products will be registered not only (80)\r\n    axios.get(\"http://localhost:5000/products\").then((response) => {\r\n      this.props.setFullArrayOfProducts(response.data);\r\n    });\r\n  };\r\n  componentDidMount() {\r\n    //Call function to get products when components load\r\n    this.GetProducts();\r\n  }\r\n  //Handle Scrolling  to give more products\r\n  handleScroll = async (e) => {\r\n    const {\r\n      Index,\r\n      setDisplayedArrayOfProducts,\r\n      DisplayedProductsArray,\r\n      ProductsFullArray,\r\n    } = this.props;\r\n\r\n    if (\r\n      //Check when users reach the bottom\r\n      e.target.scrollHeight - e.target.scrollTop === e.target.clientHeight &&\r\n      Index <= 481\r\n    ) {\r\n      // Tell message to the user in ex \"Loading more\"\r\n      await this.props.setValueByName({\r\n        name: \"AddsIndexes\",\r\n        value: [...this.props.AddsIndexes, this.findRandomNotFirstAdd()],\r\n      });\r\n      // Set timeout so even if data come faster Loading will be shown to users for 1/3s just for design\r\n      await setTimeout(async () => {\r\n        await this.props.setValueByName({\r\n          name: \"Index\",\r\n          value: Index + 20,\r\n        });\r\n        //Get more products from full array that i use in redux state\r\n        await setDisplayedArrayOfProducts(\r\n          DisplayedProductsArray.concat(\r\n            ProductsFullArray.slice(Index, Index + 20)\r\n          )\r\n        );\r\n        // Keep truck of index\r\n        await this.props.setValueByName({\r\n          name: \"Index\",\r\n          value: Index + 20,\r\n        });\r\n        //Stop loading more\r\n        await this.props.setValueByName({\r\n          name: \"LoadingMore\",\r\n          value: false,\r\n        });\r\n        //Check if all products have been displayed\r\n        if (\r\n          Index <= ProductsFullArray.length &&\r\n          Index >= ProductsFullArray.length - 20\r\n        ) {\r\n          setDisplayedArrayOfProducts(ProductsFullArray);\r\n        }\r\n      }, 300);\r\n    }\r\n  };\r\n  findRandomNotFirstAdd = () => {\r\n    let zIndex = Math.floor(Math.random() * 1000);\r\n    while (\r\n      zIndex == this.props.AddsIndexes[this.props.AddsIndexes.length - 1]\r\n    ) {\r\n      zIndex = Math.floor(Math.random() * 1000);\r\n    }\r\n    return zIndex;\r\n  };\r\n  render() {\r\n    let ProductsCount = 0;\r\n\r\n    const {\r\n      DisplayedProductsArray,\r\n      SpinnerVissibility,\r\n      LoadingMore,\r\n      Index,\r\n      ProductsFullArray,\r\n      AddsIndexes,\r\n      ViewOfPage,\r\n      setViewOfPage,\r\n    } = this.props;\r\n    return (\r\n      <div className=\"filter-Products-Header\">\r\n        <div className=\"Filter-Header\">\r\n          <Filter />\r\n        </div>\r\n        <div className=\"SwitchView\" onClick={setViewOfPage}>\r\n          {ViewOfPage === \"Pagination\"\r\n            ? \"Turn on Scrolling View\"\r\n            : \"Turn on Page View\"}\r\n        </div>\r\n\r\n        <div className=\"Products\" onScroll={this.handleScroll}>\r\n          {SpinnerVissibility === true ? (\r\n            <Spinner></Spinner>\r\n          ) : (\r\n            DisplayedProductsArray.map((Product) => {\r\n              ProductsCount++;\r\n\r\n              return ProductsCount % 20 == 0 ? (\r\n                <div>\r\n                  <div id={Product.id} className=\"Each-Product\">\r\n                    <span\r\n                      className=\"face\"\r\n                      style={{ fontSize: `${Product.size}px` }}\r\n                    >\r\n                      {Product.face}\r\n                    </span>\r\n                    <button className=\"OrderNow\">Order now</button>\r\n                    <div className=\"price\">\r\n                      $\r\n                      <span\r\n                        style={{ color: \"black\" }}\r\n                      >{` ${Product.price}`}</span>\r\n                    </div>\r\n                    <div className=\"date\">\r\n                      {`${this.findCorrectDateFormat(new Date(Product.date))}`}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"advertisment\">\r\n                    <img\r\n                      onLoad={() => {}}\r\n                      class=\"ad\"\r\n                      src={`http://localhost:5000/ads?r=${\r\n                        AddsIndexes[ProductsCount / 20]\r\n                      }`}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              ) : (\r\n                <div id={Product.id} className=\"Each-Product\">\r\n                  <span\r\n                    className=\"face\"\r\n                    style={{ fontSize: `${Product.size}px` }}\r\n                  >\r\n                    {Product.face}\r\n                  </span>\r\n                  <button className=\"OrderNow\">Order now</button>\r\n                  <div className=\"price\">\r\n                    $\r\n                    <span\r\n                      style={{ color: \"black\" }}\r\n                    >{` ${Product.price}`}</span>\r\n                  </div>\r\n                  <div className=\"date\">\r\n                    {`${this.findCorrectDateFormat(new Date(Product.date))}`}\r\n                  </div>\r\n                </div>\r\n              );\r\n            })\r\n          )}\r\n          {LoadingMore === true ? (\r\n            <div className=\"LoadingMoreend\">Loading ...</div>\r\n          ) : null}\r\n          {Index != 0 && Index === ProductsFullArray.length ? (\r\n            <div className=\"LoadingMoreend\">end of catalogue</div>\r\n          ) : null}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\nconst mapStateToProps = (state) => ({\r\n  DisplayedProductsArray: state.shop.DisplayedProductsArray,\r\n  ProductsFullArray: state.shop.ProductsFullArray,\r\n  Index: state.shop.Index,\r\n  LoadingMore: state.shop.LoadingMore,\r\n  SpinnerVissibility: state.spinner.SpinnerVissibility,\r\n  NoMoreToShow: state.shop.NoMoreToShow,\r\n  AddsIndexes: state.shop.AddsIndexes,\r\n  ViewOfPage: state.page.ViewOfPage,\r\n});\r\nconst mapDispatchToProps = (dispatch) => ({\r\n  setFullArrayOfProducts: (FullArrayOfProducts) =>\r\n    dispatch(setFullArrayOfProducts(FullArrayOfProducts)),\r\n  setDisplayedArrayOfProducts: (DisplayedArrayOfProducts) =>\r\n    dispatch(setDisplayedArrayOfProducts(DisplayedArrayOfProducts)),\r\n  toggleSpinner: () => dispatch(toggleSpinner()),\r\n  setValueByName: (NameValue) => dispatch(setValueByName(NameValue)),\r\n  setViewOfPage: () => dispatch(setViewOfPage()),\r\n});\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\r\n"]},"metadata":{},"sourceType":"module"}