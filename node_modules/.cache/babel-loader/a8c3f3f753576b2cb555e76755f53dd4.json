{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\asjan\\\\Desktop\\\\Creatella\\\\src\\\\components\\\\ProductScrollView\\\\ProductScrollView.component.jsx\";\nimport React, { useState } from \"react\";\nimport Spinner from \"../Spinner/spinner.component\";\nimport { connect } from \"react-redux\";\nimport ProductCard from \"../Product/Product.component\";\nimport { setDisplayedArrayOfProducts, setValueByName } from \"../../redux/Shop/Shop.actions\";\n\nconst findRandomNotFirstAdd = AddsIndexes => {\n  let zIndex = Math.floor(Math.random() * 1000);\n\n  while (zIndex == AddsIndexes[AddsIndexes.length - 1]) {\n    zIndex = Math.floor(Math.random() * 1000);\n  }\n\n  return zIndex;\n};\n\nconst handleScroll = async (e, Index, setDisplayedArrayOfProducts, DisplayedProductsArray, ProductsFullArray, AddsIndexes, setValueByName) => {\n  if ( //Check when users reach the bottom\n  e.target.scrollHeight - e.target.scrollTop === e.target.clientHeight && Index <= 481) {\n    await setValueByName({\n      name: \"LoadingMore\",\n      value: true\n    }); // Tell message to the user in ex \"Loading more\"\n\n    await setValueByName({\n      name: \"AddsIndexes\",\n      value: [...AddsIndexes, findRandomNotFirstAdd(AddsIndexes)]\n    }); // Set timeout so even if data come faster Loading will be shown to users for 1/3s just for design\n\n    await setTimeout(async () => {\n      await setValueByName({\n        name: \"Index\",\n        value: Index + 20\n      }); //Get more products from full array that i use in redux state\n\n      await setDisplayedArrayOfProducts(DisplayedProductsArray.concat(ProductsFullArray.slice(Index, Index + 20))); // Keep truck of index\n\n      await setValueByName({\n        name: \"Index\",\n        value: Index + 20\n      }); //Stop loading more\n\n      await setValueByName({\n        name: \"LoadingMore\",\n        value: false\n      }); //Check if all products have been displayed\n\n      if (Index <= ProductsFullArray.length && Index >= ProductsFullArray.length - 20) {\n        setDisplayedArrayOfProducts(ProductsFullArray);\n      }\n    }, 300);\n  }\n};\n\nconst ProductScrollView = ({\n  DisplayedProductsArray,\n  SpinnerVissibility,\n  AddsIndexes,\n  LoadingMore,\n  Index,\n  setDisplayedArrayOfProducts,\n  ProductsFullArray,\n  setValueByName\n}) => {\n  const [ProductsCount, setProductsCount] = useState(0);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"Products\",\n    onScroll: e => {\n      handleScroll(e, Index, setDisplayedArrayOfProducts, DisplayedProductsArray, ProductsFullArray, AddsIndexes, setValueByName);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 5\n    }\n  }, SpinnerVissibility === true ? /*#__PURE__*/React.createElement(Spinner, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 9\n    }\n  }) : DisplayedProductsArray.map(Product => {\n    setProductsCount(ProductsCount + 1);\n    return ProductsCount % 20 == 0 ? /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(ProductCard, {\n      id: Product.id,\n      price: Product.price,\n      size: Product.size,\n      face: Product.face,\n      date: Product.date,\n      AddsIndexes: AddsIndexes,\n      ProductsCount: ProductsCount,\n      AdsVisibility: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 15\n      }\n    })) : /*#__PURE__*/React.createElement(ProductCard, {\n      id: Product.id,\n      price: Product.price,\n      size: Product.size,\n      face: Product.face,\n      date: Product.date,\n      AddsIndexes: AddsIndexes,\n      ProductsCount: ProductsCount,\n      AdsVisibility: false,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 13\n      }\n    });\n  }), LoadingMore === true ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"LoadingMoreend\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 9\n    }\n  }, \"Loading ...\") : null, Index != 0 && Index === ProductsFullArray.length ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"LoadingMoreend\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 9\n    }\n  }, \"end of catalogue\") : null);\n};\n\nconst mapStateToProps = state => ({\n  DisplayedProductsArray: state.shop.DisplayedProductsArray,\n  ProductsFullArray: state.shop.ProductsFullArray,\n  SpinnerVissibility: state.spinner.SpinnerVissibility,\n  AddsIndexes: state.shop.AddsIndexes,\n  Index: state.shop.Index,\n  LoadingMore: state.shop.LoadingMore\n});\n\nconst mapDispatchToProps = dispatch => ({\n  setDisplayedArrayOfProducts: DisplayedArrayOfProducts => dispatch(setDisplayedArrayOfProducts(DisplayedArrayOfProducts)),\n  setValueByName: NameValue => dispatch(setValueByName(NameValue))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ProductScrollView);","map":{"version":3,"sources":["C:/Users/asjan/Desktop/Creatella/src/components/ProductScrollView/ProductScrollView.component.jsx"],"names":["React","useState","Spinner","connect","ProductCard","setDisplayedArrayOfProducts","setValueByName","findRandomNotFirstAdd","AddsIndexes","zIndex","Math","floor","random","length","handleScroll","e","Index","DisplayedProductsArray","ProductsFullArray","target","scrollHeight","scrollTop","clientHeight","name","value","setTimeout","concat","slice","ProductScrollView","SpinnerVissibility","LoadingMore","ProductsCount","setProductsCount","map","Product","id","price","size","face","date","mapStateToProps","state","shop","spinner","mapDispatchToProps","dispatch","DisplayedArrayOfProducts","NameValue"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;AACA,OAAOC,OAAP,MAAoB,8BAApB;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAOC,WAAP,MAAwB,8BAAxB;AACA,SACEC,2BADF,EAEEC,cAFF,QAGO,+BAHP;;AAIA,MAAMC,qBAAqB,GAAIC,WAAD,IAAiB;AAC7C,MAAIC,MAAM,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,IAA3B,CAAb;;AACA,SAAOH,MAAM,IAAID,WAAW,CAACA,WAAW,CAACK,MAAZ,GAAqB,CAAtB,CAA5B,EAAsD;AACpDJ,IAAAA,MAAM,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,IAA3B,CAAT;AACD;;AACD,SAAOH,MAAP;AACD,CAND;;AAOA,MAAMK,YAAY,GAAG,OACnBC,CADmB,EAEnBC,KAFmB,EAGnBX,2BAHmB,EAInBY,sBAJmB,EAKnBC,iBALmB,EAMnBV,WANmB,EAOnBF,cAPmB,KAQhB;AACH,OACE;AACAS,EAAAA,CAAC,CAACI,MAAF,CAASC,YAAT,GAAwBL,CAAC,CAACI,MAAF,CAASE,SAAjC,KAA+CN,CAAC,CAACI,MAAF,CAASG,YAAxD,IACAN,KAAK,IAAI,GAHX,EAIE;AACA,UAAMV,cAAc,CAAC;AACnBiB,MAAAA,IAAI,EAAE,aADa;AAEnBC,MAAAA,KAAK,EAAE;AAFY,KAAD,CAApB,CADA,CAKA;;AACA,UAAMlB,cAAc,CAAC;AACnBiB,MAAAA,IAAI,EAAE,aADa;AAEnBC,MAAAA,KAAK,EAAE,CAAC,GAAGhB,WAAJ,EAAiBD,qBAAqB,CAACC,WAAD,CAAtC;AAFY,KAAD,CAApB,CANA,CAUA;;AACA,UAAMiB,UAAU,CAAC,YAAY;AAC3B,YAAMnB,cAAc,CAAC;AACnBiB,QAAAA,IAAI,EAAE,OADa;AAEnBC,QAAAA,KAAK,EAAER,KAAK,GAAG;AAFI,OAAD,CAApB,CAD2B,CAK3B;;AACA,YAAMX,2BAA2B,CAC/BY,sBAAsB,CAACS,MAAvB,CACER,iBAAiB,CAACS,KAAlB,CAAwBX,KAAxB,EAA+BA,KAAK,GAAG,EAAvC,CADF,CAD+B,CAAjC,CAN2B,CAW3B;;AACA,YAAMV,cAAc,CAAC;AACnBiB,QAAAA,IAAI,EAAE,OADa;AAEnBC,QAAAA,KAAK,EAAER,KAAK,GAAG;AAFI,OAAD,CAApB,CAZ2B,CAgB3B;;AACA,YAAMV,cAAc,CAAC;AACnBiB,QAAAA,IAAI,EAAE,aADa;AAEnBC,QAAAA,KAAK,EAAE;AAFY,OAAD,CAApB,CAjB2B,CAqB3B;;AACA,UACER,KAAK,IAAIE,iBAAiB,CAACL,MAA3B,IACAG,KAAK,IAAIE,iBAAiB,CAACL,MAAlB,GAA2B,EAFtC,EAGE;AACAR,QAAAA,2BAA2B,CAACa,iBAAD,CAA3B;AACD;AACF,KA5Be,EA4Bb,GA5Ba,CAAhB;AA6BD;AACF,CAtDD;;AAuDA,MAAMU,iBAAiB,GAAG,CAAC;AACzBX,EAAAA,sBADyB;AAEzBY,EAAAA,kBAFyB;AAGzBrB,EAAAA,WAHyB;AAIzBsB,EAAAA,WAJyB;AAKzBd,EAAAA,KALyB;AAMzBX,EAAAA,2BANyB;AAOzBa,EAAAA,iBAPyB;AAQzBZ,EAAAA;AARyB,CAAD,KASpB;AACJ,QAAM,CAACyB,aAAD,EAAgBC,gBAAhB,IAAoC/B,QAAQ,CAAC,CAAD,CAAlD;AACA,sBACE;AACE,IAAA,SAAS,EAAC,UADZ;AAEE,IAAA,QAAQ,EAAGc,CAAD,IAAO;AACfD,MAAAA,YAAY,CACVC,CADU,EAEVC,KAFU,EAGVX,2BAHU,EAIVY,sBAJU,EAKVC,iBALU,EAMVV,WANU,EAOVF,cAPU,CAAZ;AASD,KAZH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAcGuB,kBAAkB,KAAK,IAAvB,gBACC,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADD,GAGCZ,sBAAsB,CAACgB,GAAvB,CAA4BC,OAAD,IAAa;AACtCF,IAAAA,gBAAgB,CAACD,aAAa,GAAG,CAAjB,CAAhB;AAEA,WAAOA,aAAa,GAAG,EAAhB,IAAsB,CAAtB,gBACL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,WAAD;AACE,MAAA,EAAE,EAAEG,OAAO,CAACC,EADd;AAEE,MAAA,KAAK,EAAED,OAAO,CAACE,KAFjB;AAGE,MAAA,IAAI,EAAEF,OAAO,CAACG,IAHhB;AAIE,MAAA,IAAI,EAAEH,OAAO,CAACI,IAJhB;AAKE,MAAA,IAAI,EAAEJ,OAAO,CAACK,IALhB;AAME,MAAA,WAAW,EAAE/B,WANf;AAOE,MAAA,aAAa,EAAEuB,aAPjB;AAQE,MAAA,aAAa,EAAE,IARjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADK,gBAcL,oBAAC,WAAD;AACE,MAAA,EAAE,EAAEG,OAAO,CAACC,EADd;AAEE,MAAA,KAAK,EAAED,OAAO,CAACE,KAFjB;AAGE,MAAA,IAAI,EAAEF,OAAO,CAACG,IAHhB;AAIE,MAAA,IAAI,EAAEH,OAAO,CAACI,IAJhB;AAKE,MAAA,IAAI,EAAEJ,OAAO,CAACK,IALhB;AAME,MAAA,WAAW,EAAE/B,WANf;AAOE,MAAA,aAAa,EAAEuB,aAPjB;AAQE,MAAA,aAAa,EAAE,KARjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAdF;AAyBD,GA5BD,CAjBJ,EA+CGD,WAAW,KAAK,IAAhB,gBACC;AAAK,IAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBADD,GAEG,IAjDN,EAkDGd,KAAK,IAAI,CAAT,IAAcA,KAAK,KAAKE,iBAAiB,CAACL,MAA1C,gBACC;AAAK,IAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADD,GAEG,IApDN,CADF;AAwDD,CAnED;;AAoEA,MAAM2B,eAAe,GAAIC,KAAD,KAAY;AAClCxB,EAAAA,sBAAsB,EAAEwB,KAAK,CAACC,IAAN,CAAWzB,sBADD;AAElCC,EAAAA,iBAAiB,EAAEuB,KAAK,CAACC,IAAN,CAAWxB,iBAFI;AAIlCW,EAAAA,kBAAkB,EAAEY,KAAK,CAACE,OAAN,CAAcd,kBAJA;AAKlCrB,EAAAA,WAAW,EAAEiC,KAAK,CAACC,IAAN,CAAWlC,WALU;AAMlCQ,EAAAA,KAAK,EAAEyB,KAAK,CAACC,IAAN,CAAW1B,KANgB;AAOlCc,EAAAA,WAAW,EAAEW,KAAK,CAACC,IAAN,CAAWZ;AAPU,CAAZ,CAAxB;;AASA,MAAMc,kBAAkB,GAAIC,QAAD,KAAe;AACxCxC,EAAAA,2BAA2B,EAAGyC,wBAAD,IAC3BD,QAAQ,CAACxC,2BAA2B,CAACyC,wBAAD,CAA5B,CAF8B;AAGxCxC,EAAAA,cAAc,EAAGyC,SAAD,IAAeF,QAAQ,CAACvC,cAAc,CAACyC,SAAD,CAAf;AAHC,CAAf,CAA3B;;AAKA,eAAe5C,OAAO,CAACqC,eAAD,EAAkBI,kBAAlB,CAAP,CAA6ChB,iBAA7C,CAAf","sourcesContent":["import React, { useState } from \"react\";\r\nimport Spinner from \"../Spinner/spinner.component\";\r\nimport { connect } from \"react-redux\";\r\nimport ProductCard from \"../Product/Product.component\";\r\nimport {\r\n  setDisplayedArrayOfProducts,\r\n  setValueByName,\r\n} from \"../../redux/Shop/Shop.actions\";\r\nconst findRandomNotFirstAdd = (AddsIndexes) => {\r\n  let zIndex = Math.floor(Math.random() * 1000);\r\n  while (zIndex == AddsIndexes[AddsIndexes.length - 1]) {\r\n    zIndex = Math.floor(Math.random() * 1000);\r\n  }\r\n  return zIndex;\r\n};\r\nconst handleScroll = async (\r\n  e,\r\n  Index,\r\n  setDisplayedArrayOfProducts,\r\n  DisplayedProductsArray,\r\n  ProductsFullArray,\r\n  AddsIndexes,\r\n  setValueByName\r\n) => {\r\n  if (\r\n    //Check when users reach the bottom\r\n    e.target.scrollHeight - e.target.scrollTop === e.target.clientHeight &&\r\n    Index <= 481\r\n  ) {\r\n    await setValueByName({\r\n      name: \"LoadingMore\",\r\n      value: true,\r\n    });\r\n    // Tell message to the user in ex \"Loading more\"\r\n    await setValueByName({\r\n      name: \"AddsIndexes\",\r\n      value: [...AddsIndexes, findRandomNotFirstAdd(AddsIndexes)],\r\n    });\r\n    // Set timeout so even if data come faster Loading will be shown to users for 1/3s just for design\r\n    await setTimeout(async () => {\r\n      await setValueByName({\r\n        name: \"Index\",\r\n        value: Index + 20,\r\n      });\r\n      //Get more products from full array that i use in redux state\r\n      await setDisplayedArrayOfProducts(\r\n        DisplayedProductsArray.concat(\r\n          ProductsFullArray.slice(Index, Index + 20)\r\n        )\r\n      );\r\n      // Keep truck of index\r\n      await setValueByName({\r\n        name: \"Index\",\r\n        value: Index + 20,\r\n      });\r\n      //Stop loading more\r\n      await setValueByName({\r\n        name: \"LoadingMore\",\r\n        value: false,\r\n      });\r\n      //Check if all products have been displayed\r\n      if (\r\n        Index <= ProductsFullArray.length &&\r\n        Index >= ProductsFullArray.length - 20\r\n      ) {\r\n        setDisplayedArrayOfProducts(ProductsFullArray);\r\n      }\r\n    }, 300);\r\n  }\r\n};\r\nconst ProductScrollView = ({\r\n  DisplayedProductsArray,\r\n  SpinnerVissibility,\r\n  AddsIndexes,\r\n  LoadingMore,\r\n  Index,\r\n  setDisplayedArrayOfProducts,\r\n  ProductsFullArray,\r\n  setValueByName,\r\n}) => {\r\n  const [ProductsCount, setProductsCount] = useState(0);\r\n  return (\r\n    <div\r\n      className=\"Products\"\r\n      onScroll={(e) => {\r\n        handleScroll(\r\n          e,\r\n          Index,\r\n          setDisplayedArrayOfProducts,\r\n          DisplayedProductsArray,\r\n          ProductsFullArray,\r\n          AddsIndexes,\r\n          setValueByName\r\n        );\r\n      }}\r\n    >\r\n      {SpinnerVissibility === true ? (\r\n        <Spinner></Spinner>\r\n      ) : (\r\n        DisplayedProductsArray.map((Product) => {\r\n          setProductsCount(ProductsCount + 1);\r\n\r\n          return ProductsCount % 20 == 0 ? (\r\n            <div>\r\n              <ProductCard\r\n                id={Product.id}\r\n                price={Product.price}\r\n                size={Product.size}\r\n                face={Product.face}\r\n                date={Product.date}\r\n                AddsIndexes={AddsIndexes}\r\n                ProductsCount={ProductsCount}\r\n                AdsVisibility={true}\r\n              />\r\n            </div>\r\n          ) : (\r\n            <ProductCard\r\n              id={Product.id}\r\n              price={Product.price}\r\n              size={Product.size}\r\n              face={Product.face}\r\n              date={Product.date}\r\n              AddsIndexes={AddsIndexes}\r\n              ProductsCount={ProductsCount}\r\n              AdsVisibility={false}\r\n            />\r\n          );\r\n        })\r\n      )}\r\n      {LoadingMore === true ? (\r\n        <div className=\"LoadingMoreend\">Loading ...</div>\r\n      ) : null}\r\n      {Index != 0 && Index === ProductsFullArray.length ? (\r\n        <div className=\"LoadingMoreend\">end of catalogue</div>\r\n      ) : null}\r\n    </div>\r\n  );\r\n};\r\nconst mapStateToProps = (state) => ({\r\n  DisplayedProductsArray: state.shop.DisplayedProductsArray,\r\n  ProductsFullArray: state.shop.ProductsFullArray,\r\n\r\n  SpinnerVissibility: state.spinner.SpinnerVissibility,\r\n  AddsIndexes: state.shop.AddsIndexes,\r\n  Index: state.shop.Index,\r\n  LoadingMore: state.shop.LoadingMore,\r\n});\r\nconst mapDispatchToProps = (dispatch) => ({\r\n  setDisplayedArrayOfProducts: (DisplayedArrayOfProducts) =>\r\n    dispatch(setDisplayedArrayOfProducts(DisplayedArrayOfProducts)),\r\n  setValueByName: (NameValue) => dispatch(setValueByName(NameValue)),\r\n});\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ProductScrollView);\r\n"]},"metadata":{},"sourceType":"module"}